# TUI 代码优化规范

> 本规范由拥有20年前端开发经验的Vue3高级工程师制定，适用于TUI组件库的代码优化工作。遵循这些规则可确保代码质量、可维护性和团队协作效率。严格执行这些标准将帮助我们建立一个一致、高效的代码库。

## 核心原则

- **可读性优先**：代码是写给人看的，其次才是给机器执行的
- **一致性**：保持整个项目的风格一致，降低认知负担
- **语义化**：变量、函数和组件的命名应当清晰地表达其用途和含义
- **简洁性**：移除冗余代码，保持代码精简但不失可读性
- **可维护性**：考虑代码的长期维护成本，而不仅仅是当前的实现便利

## 1. 命名规范优化

### 1.1 变量与函数命名
- 优化函数或变量名称，使其更加语义化，便于理解
- 状态变量使用`state`前缀的无需修改（符合项目约定）
- 事件处理函数必须以`handle`开头，如`handleClick`、`handleChange`
- 布尔类型变量应使用`is`、`has`、`should`等前缀，如`isVisible`、`hasPermission`
- 避免使用无意义的通用名称，如`data`、`temp`、`foo`

### 1.2 组件命名
- 组件引用时使用kebab-case（短横线）命名法：`t-xxx`而非驼峰式`TXxx`
- 组件定义时使用PascalCase（帕斯卡）命名法，并以`T`开头
- getter方法应遵循标准命名规范，避免使用`getXXX`形式（除非确实是获取操作）

### 1.3 CSS类命名
- 外层类使用`t-xxx`格式（组件前缀）
- 内嵌元素使用`_xxx`格式（单下划线前缀）
- 避免使用`xxxClasses`这样的命名，优化为更语义化的名称
- 修改类名时必须同步修改对应的SCSS文件

### 1.4 计算样式类名命名
- 计算类名的变量应使用`xxxClasses`形式，如`buttonClasses`、`optionClasses`
- 避免使用`getXxx`形式命名计算类名变量
- 类名变量应以所属组件名称前缀，如`buttonClasses`、`selectClasses`
- 与DOM元素相关的类名计算，应使用更具体的名称，如`itemClasses`、`headerClasses`

## 2. 代码结构优化

### 2.1 导入(import)规则
- 类型导入必须放在最上面，其他导入放在下面
- 如果一个导入同时包含类型和其他内容，类型必须放在最前面
- 组件导入禁止使用相对路径`../`，必须使用`@/packages`绝对路径方式
- 导入语句按以下顺序排列：
  1. Vue相关导入（vue, vue-router等）
  2. 类型导入（Type imports）
  3. 第三方库导入
  4. 项目内组件导入
  5. 工具函数、常量、样式导入

### 2.2 代码组织
- 优化代码结构，使其更加清晰，便于维护
- 删除无用代码和与业务逻辑无关的代码
- 复杂的类名计算逻辑应抽离为计算属性
- 相关的逻辑应当分组放置，使用注释明确分隔不同功能区块
- 保持每个函数的单一职责，避免过长函数

## 3. 注释规范

### 3.1 JSDoc规范
- 优化代码注释，使用JSDoc格式（`/** */`）
- 组件、函数、复杂逻辑必须添加注释说明用途
- 组件props必须有注释说明其类型、用途和可选值
- 示例注释格式：
  ```typescript
  /**
   * @description 处理按钮点击事件
   * @param {MouseEvent} event - 鼠标事件对象
   * @returns {void}
   */
  const handleClick = (event: MouseEvent): void => {
    // 实现...
  };
  ```

### 3.2 注释内容要求
- 注释应说明"为什么"而不仅仅是"是什么"
- 对于复杂算法或业务逻辑，必须添加详细说明
- 对于临时解决方案或待优化的代码，使用`// TODO:`标记
- 发现注释不规范或缺失时，需要补充完善

## 4. 代码格式与排版

### 4.1 格式规范
- 优化代码格式，使其更加美观，便于阅读
- 相关代码块之间添加适当空行增强可读性
- 嵌套不应超过4层，过深的嵌套应当重构
- 单行代码长度不应超过100个字符
- 使用2个空格进行缩进（项目标准）

### 4.2 Vue组件结构
- Vue组件应遵循以下结构顺序：
  1. template
  2. script (包含类型定义、props、emits等)
  3. style
- Script部分应按照以下顺序组织：
  1. 导入语句
  2. 类型定义
  3. 组件选项(defineOptions)
  4. Props定义
  5. Emits定义
  6. 响应式数据(ref/reactive)
  7. 计算属性(computed)
  8. 生命周期钩子
  9. 方法定义
  10. watch定义

## 5. Vue3特定优化

### 5.1 组件通信
- 使用`defineEmits`替代`$emit`进行事件通信
- 所有绑定函数使用kebab-case命名，emit触发同理
  - 示例：`@click-row` 对应 `emit('click-row')`
- 避免使用事件总线，优先使用props/emits或状态管理

### 5.2 Composition API最佳实践
- 优先使用`<script setup>`语法
- 使用`defineProps`和`defineEmits`而非选项式API
- 相关逻辑应当组织在一起，而不是按照生命周期分散
- 复杂组合逻辑应抽取为可复用的组合式函数（composables）

## 6. TypeScript规范

### 6.1 类型定义
- 所有函数参数和返回值必须有明确的类型标注
- 避免使用`any`类型，优先使用准确的类型或`unknown`
- 为复杂对象创建接口或类型别名
- 组件props和emits必须有完整的类型定义

### 6.2 类型导入与使用
- 使用`type`关键字导入类型，明确区分类型导入和值导入
- 组合类型时优先使用交叉类型（&）而非继承
- 利用TypeScript的字面量类型和联合类型增强代码安全性

## 7. SCSS样式规范

### 7.1 样式组织
- 样式应遵循BEM命名方法论
- 避免深层嵌套，最多不超过3层
- 公共样式应抽取到通用样式文件中
- 组件特有样式应当放在组件的style标签内

### 7.2 样式变量
- 必须使用`@/styles/index.scss`中定义的全局变量
- 禁止在组件内创建新的自定义变量
- 颜色值必须使用预定义变量，避免硬编码

## 8. 引用与路径

### 8.1 路径别名
- 引用项目内文件时，使用`@`别名代替相对路径
- 例如使用`@/packages/button`而不是`../../packages/button`
- 本地组件引用可以使用相对路径

## 9. 测试与代码质量

### 9.1 代码审查清单
- 检查文件夹下所有文件是否符合上述规范
- 组件是否按照Button组件模板实现
- 检查导出文件(index.ts)是否规范（主要优化注释）
- 验证事件绑定和触发是否使用kebab-case命名

## 重要提示

最后重点：优化过程中**不要修改代码逻辑**。优化应当集中在代码风格、结构组织和命名规范上，确保功能不受影响。
